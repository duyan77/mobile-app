{% extends "./base.html" %}

{% load static %}

{% block content %}
<style>
    body {
        background-color: #E0E0E0;
    }

    .col {
        transition: transform 0.3s ease;
    }

    .col:hover {
        transform: translateY(-10px);
    }

    .slideshow-container {
        position: relative;
        width: 80%;
        margin: 0 auto;
        overflow: hidden;
    }

    #banner {
        width: 100%;
        max-width: 1300px;
        margin: 0 auto;
    }

    /* Điều chỉnh các nút điều hướng */
    #banner .prev,
    #banner .next {
        top: 50%;
        transform: translateY(-50%);
    }

    /* Đảm bảo hình ảnh chiếm hết chiều rộng của banner */
    #banner .mySlides img {
        width: 100%;
    }


    .mySlides {
        display: none;
        position: relative;
        width: 100%;
        transition: transform 1s ease;
        /* Hiệu ứng trượt ngang */
    }

    .mySlides img {
        width: 100%;
        display: block;
    }



    .prev,
    .next {
        cursor: pointer;
        position: absolute;
        top: 50%;
        width: auto;
        margin-top: -22px;
        padding: 16px;
        color: white;
        font-weight: bold;
        font-size: 18px;
        transition: 0.6s ease;
        border-radius: 0 3px 3px 0;
        user-select: none;
    }

    .next {
        right: 0;
        border-radius: 3px 0 0 3px;
    }

    .prev:hover,
    .next:hover {
        background-color: rgba(0, 0, 0, 0.8);
    }

    .snowflake {
        position: fixed;
        top: -10px;
        width: 10px;
        height: 10px;
        background: white;
        border-radius: 50%;
        opacity: 0.8;
        pointer-events: none;
        animation: fall linear infinite;
    }

    @keyframes fall {
        to {
            transform: translateY(100vh);
        }
    }

    /* ////////////////////////////test////////////////////////////////////////////////// */
    /* Comments Section */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    .comments-section {
        max-width: 1200px;
        margin: 20px auto;
        padding: 20px;
    }

    h3 {
        margin-bottom: 20px;
        font-size: 24px;
    }

    .comments-layout {
        display: flex;
        gap: 30px;
    }

    .new-comment-form {
        width: 33%;
        position: sticky;
        top: 20px;
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .comment-input {
        width: 100%;
        min-height: 200px;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 8px;
        margin-bottom: 15px;
        resize: none;
        font-family: inherit;
    }

    .btn-submit-comment {
        width: 100%;
        padding: 10px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .btn-submit-comment:hover {
        background-color: #0056b3;
    }

    .comments-container {
        width: 67%;
    }

    .comment-card {
        background: white;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .comment-content {
        margin-bottom: 10px;
        line-height: 1.5;
    }

    .comment-time {
        color: #666;
        font-size: 14px;
    }

    @media (max-width: 768px) {
        .comments-layout {
            flex-direction: column;
        }

        .new-comment-form,
        .comments-container {
            width: 100%;
        }

        .new-comment-form {
            position: static;
        }
    }
</style>
<!-- banner section -->
<div class="slideshow-container mt-5 pt-4" id="banner">
    <div class="mySlides">
        <img src="{% static 'media/images/ip2.jpg' %}" style="width:100%">
    </div>
    <div class="mySlides">
        <img src="{% static 'media/images/lap2.jpg' %}" style="width:100%">
    </div>
    <div class="mySlides">
        <img src="{% static 'media/images/ss2.jpg' %}" style="width:100%">
    </div>
    <a class="prev" onclick="changeSlide(-1)">&#10094;</a>
    <a class="next" onclick="changeSlide(1)">&#10095;</a>
</div>



<!-- Introduction section -->
<section class="py-4 text-center container ">
    <div class="row py-lg-5">
        <div class="col-lg-6 col-md-8 mx-auto">
            <h4> Welcome to Mobile Store.</h4>
            <p class="lead text-muted">
                Find the best mobile phones and accessories here.
            </p>
            <p class="lead text-muted">
                Developed and implemented in the Information System Security subject
            </p>
            <br>
            <a href="#" class="btn btn-primary my-2"> Shop Now </a>
        </div>
    </div>
</section>

<!-- All products section -->
<div class="album py-5 bg-light">
    <div class="container">
        <div class="pb-3 h5"> All products</div>
        <hr>
        <br>
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-5 g-3">
            {% for product in all_products %}
            <div class="col">
                <div class="card shadow-sm d-flex flex-column h-100">
                    <img class="img-fluid pt-2" alt="{{ product.title }}" src="{{ product.image.url }}">
                    <div class="card-body mt-auto">
                        <p class="card-text">
                            <a class="text-info text-decoration-none" href="{{ product.get_absolute_url }}">
                                {{ product.title | capfirst }}
                            </a>
                        </p>
                        <div class="d-flex justify-content-between align-items-center">
                            <h5>{{ product.formatted_price }}</h5>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- HTML -->
<section class="comments-section">
    <h3>Comments</h3>
    <div class="comments-layout">
        <!-- Left Column - Comment Form -->
        <div class="new-comment-form">
            <textarea id="comment-input" placeholder="Write a comment..." class="comment-input"></textarea>
            <button id="btn-submit-comment" class="btn-submit-comment">Submit</button>
        </div>

        <!-- Right Column - Comments Display -->
        <div class="comments-container" id="comments-container">
            <!-- Comments will be added here -->
        </div>
    </div>
</section>

<script>
    const createSnowflake = () => {
        const banner = document.getElementById('banner');
        const snowflake = document.createElement('div');
        snowflake.classList.add('snowflake');
        snowflake.style.left = `${Math.random() * banner.clientWidth}px`;
        snowflake.style.animationDuration = `${Math.random() * 3 + 2}s`;
        snowflake.style.opacity = Math.random();
        snowflake.style.fontSize = `${Math.random() * 10 + 10}px`;
        banner.appendChild(snowflake);

        setTimeout(() => { snowflake.remove(); }, 5000);
    }
    setInterval(createSnowflake, 100);


    let slideIndex = 0;
    let slideInterval;

    function showSlides() {
        let slides = document.getElementsByClassName("mySlides");

        // Ẩn tất cả các slides
        for (let i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }

        // Hiển thị slide hiện tại
        slides[slideIndex].style.display = "block";

        // Tự động chuyển sang slide tiếp theo sau 5 giây
        clearInterval(slideInterval);
        slideInterval = setInterval(() => changeSlide(1), 5000);
    }

    function changeSlide(n) {
        let slides = document.getElementsByClassName("mySlides");
        slideIndex += n;

        // Nếu vượt quá số lượng slide, quay lại slide đầu tiên
        if (slideIndex >= slides.length) {
            slideIndex = 0;
        }
        // Nếu lùi trước slide đầu tiên, quay lại slide cuối cùng
        else if (slideIndex < 0) {
            slideIndex = slides.length - 1;
        }

        // Hiển thị slide hiện tại
        showSlides();
    }

    // Khởi chạy slideshow tự động khi tải trang
    showSlides();

    ///////////////////////////////////////Phần commment :>> //////////////////////////////////////////////////////////////////////
    document.getElementById('btn-submit-comment').addEventListener('click', function () {
        const commentInput = document.getElementById('comment-input');
        const commentText = commentInput.value.trim();

        if (commentText) {
            // Create new comment element
            const commentCard = document.createElement('div');
            commentCard.classList.add('comment-card');

            // Add comment content with current time
            const now = new Date().toLocaleString();
            commentCard.innerHTML = `
                    <p class="comment-content">${commentText}</p>
                    <p class="comment-time">${now}</p>
                `;

            // Add comment to container at the beginning
            const container = document.getElementById('comments-container');
            container.insertBefore(commentCard, container.firstChild);

            // Clear input
            commentInput.value = '';
        }
    });

</script>
{% endblock %}